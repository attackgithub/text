{"version":3,"sources":["webpack:///./src/helpers/mime.js","webpack:///./src/views/RichWorkspace.vue?738e","webpack:///./src/views/RichWorkspace.vue?94e6","webpack:///./src/components/MenuBar.vue?48b7","webpack:///./src/components/MenuBubble.vue?29cb","webpack:///./src/views/RichWorkspace.vue?acb2","webpack:///src/views/RichWorkspace.vue","webpack:///./src/views/RichWorkspace.vue?d0bc","webpack:///./src/views/RichWorkspace.vue","webpack:///./src/views/RichWorkspace.vue?4f9b","webpack:///./src/helpers/files.js","webpack:///./src/components/MenuBar.vue?a1b9","webpack:///./src/components/MenuBar.vue?d882","webpack:///./src/components/MenuBubble.vue?d8a9","webpack:///./src/components/MenuBubble.vue?6152","webpack:///./src/components/MenuBar.vue?56c3","webpack:///./src/mixins/menubar.js","webpack:///src/components/MenuBar.vue","webpack:///./src/components/MenuBar.vue?c014","webpack:///./src/components/MenuBar.vue","webpack:///./src/components/MenuBubble.vue?b255","webpack:///./src/components/MenuBubble.vue?7a05","webpack:///src/components/MenuBubble.vue","webpack:///./src/components/MenuBubble.vue"],"names":["openMimetypesMarkdown","openMimetypesPlainText","openMimetypes","module","exports","push","i","content","locals","add","default","_vm","this","_h","$createElement","_c","_self","class","loaded","ready","attrs","file","autofocus","staticClass","on","createNew","_v","_s","t","_e","directives","name","rawName","value","expression","key","id","path","shareToken","mimetype","$event","fetchFileInfo","user","async","axios","method","url","generateRemoteUrl","headers","requesttoken","OC","requestToken","data","response","files","OCA","Files","App","fileList","filesClient","_client","parseMultiStatus","map","fileInfo","_parseFileInfo","href","registerFileCreate","newFileMenuPlugin","attach","menu","addMenuEntry","displayName","templateName","iconClass","fileType","actionHandler","createFile","then","status","fileInfoModel","FileInfoModel","Viewer","fileActions","triggerAction","Plugins","register","registerFileActionFallback","sharingToken","document","getElementById","dir","ViewerRoot","createElement","body","appendChild","registerAction","mime","PERMISSION_UPDATE","PERMISSION_READ","imagePath","filename","window","FileList","findFile","Promise","all","imports","getCurrentDirectory","Vue","prototype","n","Editor","render","h","props","fileId","active","relativePath","mimeType","$mount","length","setDefault","FilesWorkspacePlugin","el","registerHeader","bind","priority","vm","extend","RichWorkspace","propsData","$el","toString","label","isActive","action","command","undo","redo","strong","em","strike","paragraph","visible","children","heading","level","bullet_list","ordered_list","blockquote","code_block","component","editor","scopedSlots","_u","fn","ref","commands","focused","autohide","_l","icon","$index","iconCount","getIconClasses","clickIcon","hideChildMenu","childIconClass","preventDefault","toggleChildMenu","open","isChildMenuVisible","childPopoverMenu","isHiddenInMenu","childIcon","_t","hideLinkMenu","getMarkAttrs","style","setLinkUrl","link","linkUrl","domProps","type","indexOf","_k","keyCode","target","composing","showLinkMenu"],"mappings":"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","file":"editor-rich.js?v=56f90e9eecddf14b9038","sourcesContent":["/*\n * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>\n *\n * @author Julius Härtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nconst openMimetypesMarkdown = [\n\t'text/markdown',\n]\n\nconst openMimetypesPlainText = [\n\t'text/plain',\n\t'application/cmd',\n\t'application/javascript',\n\t'application/json',\n\t'application/xml',\n\t'application/x-empty',\n\t'application/x-msdos-program',\n\t'application/x-php',\n\t'application/x-pearl',\n\t'application/x-text',\n\t'application/yaml',\n]\n\nconst openMimetypes = [...openMimetypesMarkdown, ...openMimetypesPlainText]\n\nexport {\n\topenMimetypes,\n\topenMimetypesMarkdown,\n\topenMimetypesPlainText,\n}\n","import mod from \"-!../../node_modules/vue-style-loader/index.js!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RichWorkspace.vue?vue&type=style&index=0&id=455cf303&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/vue-style-loader/index.js!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RichWorkspace.vue?vue&type=style&index=0&id=455cf303&scoped=true&lang=css&\"","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"\\n#rich-workspace[data-v-455cf303] {\\n\\tpadding: 0 60px;\\n\\tmin-height: 90px;\\n\\ttext-align: left;\\n}\\n.empty-workspace[data-v-455cf303] {\\n\\tmargin-top: 54px;\\n\\tcolor: var(--color-text-maxcontrast);\\n\\theight: 0;\\n}\\n#rich-workspace[data-v-455cf303] div[contenteditable=false] {\\n\\twidth: 100%;\\n\\tpadding: 0px;\\n\\tbackground-color: var(--color-main-background);\\n\\topacity: 1;\\n\\tborder: none;\\n}\\n#rich-workspace[data-v-455cf303] #editor-container {\\n\\theight: 100%;\\n\\tposition: unset !important;\\n}\\n#rich-workspace[data-v-455cf303] #editor-wrapper {\\n\\tposition: unset !important;\\n}\\n#rich-workspace[data-v-455cf303] #editor-wrapper .ProseMirror {\\n\\tpadding: 0px;\\n\\tmargin: 0;\\n}\\n#rich-workspace[data-v-455cf303] .menubar .menubar-icons {\\n\\tmargin-left: 0;\\n}\\n#rich-workspace[data-v-455cf303] .editor__content {\\n\\tmargin: 0;\\n}\\n\", \"\"]);\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBar.vue?vue&type=style&index=0&id=58a92139&scoped=true&lang=scss&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"197758a8\", content, true, {});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBubble.vue?vue&type=style&index=0&id=b937b670&scoped=true&lang=scss&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"422f6cc2\", content, true, {});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RichWorkspace.vue?vue&type=style&index=0&id=455cf303&scoped=true&lang=css&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"9939401a\", content, true, {});","<!--\n  - @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>\n  -\n  - @author Julius Härtl <jus@bitgrid.net>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<div id=\"rich-workspace\" :class=\"{'icon-loading': !loaded || !ready }\">\n\t\t<div v-if=\"!file || (autofocus && !ready)\" class=\"empty-workspace\" @click=\"createNew\">\n\t\t\t<p class=\"placeholder\">\n\t\t\t\t{{ t('text', 'Add notes, lists or links …') }}\n\t\t\t</p>\n\t\t</div>\n\n\t\t<EditorWrapper v-if=\"file\"\n\t\t\tv-show=\"ready\"\n\t\t\t:key=\"file.id\"\n\t\t\t:file-id=\"file.id\"\n\t\t\t:relative-path=\"file.path\"\n\t\t\t:share-token=\"shareToken\"\n\t\t\t:active=\"true\"\n\t\t\t:autohide=\"true\"\n\t\t\t:mime=\"file.mimetype\"\n\t\t\t:autofocus=\"autofocus\"\n\t\t\t@ready=\"ready=true\" />\n\t</div>\n</template>\n\n<script>\nimport axios from '@nextcloud/axios'\nimport { generateOcsUrl } from '@nextcloud/router'\n\nconst IS_PUBLIC = !!(document.getElementById('isPublic'))\nconst WORKSPACE_URL = generateOcsUrl('apps/text' + (IS_PUBLIC ? '/public' : ''), 2) + 'workspace'\n\nexport default {\n\tname: 'RichWorkspace',\n\tcomponents: {\n\t\tEditorWrapper: () => import(/* webpackChunkName: \"editor\" */'./../components/EditorWrapper'),\n\t},\n\tprops: {\n\t\tpath: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tfile: null,\n\t\t\tloaded: false,\n\t\t\tready: false,\n\t\t\tautofocus: false,\n\t\t}\n\t},\n\tcomputed: {\n\t\tshareToken() {\n\t\t\treturn document.getElementById('sharingToken') ? document.getElementById('sharingToken').value : null\n\t\t},\n\t},\n\twatch: {\n\t\tpath: function() {\n\t\t\tthis.getFileInfo()\n\t\t},\n\t},\n\tasync mounted() {\n\t\tthis.getFileInfo()\n\t},\n\tmethods: {\n\t\tgetFileInfo() {\n\t\t\tthis.loaded = false\n\t\t\tthis.autofocus = false\n\t\t\tthis.ready = false\n\t\t\tconst params = { path: this.path }\n\t\t\tif (IS_PUBLIC) {\n\t\t\t\tparams.shareToken = this.shareToken\n\t\t\t}\n\t\t\taxios.get(WORKSPACE_URL, { params }).then((response) => {\n\t\t\t\tconst data = response.data.ocs.data\n\t\t\t\tthis.file = data.file\n\t\t\t\tthis.editing = true\n\t\t\t\tthis.loaded = true\n\t\t\t}).catch(() => {\n\t\t\t\tthis.file = null\n\t\t\t\tthis.loaded = true\n\t\t\t\tthis.ready = true\n\t\t\t})\n\t\t},\n\t\tcreateNew() {\n\t\t\tif (this.creating) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tthis.creating = true\n\t\t\twindow.FileList.createFile('README.md', { scrollTo: false, animate: false }).then((status, data) => {\n\t\t\t\tthis.getFileInfo()\n\t\t\t\tthis.autofocus = true\n\t\t\t\tthis.creating = false\n\t\t\t})\n\t\t},\n\t},\n}\n</script>\n\n<style scoped>\n\t#rich-workspace {\n\t\tpadding: 0 60px;\n\t\tmin-height: 90px;\n\t\ttext-align: left;\n\t}\n\n\t.empty-workspace {\n\t\tmargin-top: 54px;\n\t\tcolor: var(--color-text-maxcontrast);\n\t\theight: 0;\n\t}\n\n\t#rich-workspace::v-deep div[contenteditable=false] {\n\t\twidth: 100%;\n\t\tpadding: 0px;\n\t\tbackground-color: var(--color-main-background);\n\t\topacity: 1;\n\t\tborder: none;\n\t}\n\n\t#rich-workspace::v-deep #editor-container {\n\t\theight: 100%;\n\t\tposition: unset !important;\n\t}\n\n\t#rich-workspace::v-deep #editor-wrapper {\n\t\tposition: unset !important;\n\t}\n\n\t#rich-workspace::v-deep #editor-wrapper .ProseMirror {\n\t\tpadding: 0px;\n\t\tmargin: 0;\n\t}\n\n\t#rich-workspace::v-deep .menubar .menubar-icons {\n\t\tmargin-left: 0;\n\t}\n\n\t#rich-workspace::v-deep .editor__content {\n\t\tmargin: 0;\n\t}\n</style>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RichWorkspace.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RichWorkspace.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./RichWorkspace.vue?vue&type=template&id=455cf303&scoped=true&\"\nimport script from \"./RichWorkspace.vue?vue&type=script&lang=js&\"\nexport * from \"./RichWorkspace.vue?vue&type=script&lang=js&\"\nimport style0 from \"./RichWorkspace.vue?vue&type=style&index=0&id=455cf303&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"455cf303\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{'icon-loading': !_vm.loaded || !_vm.ready },attrs:{\"id\":\"rich-workspace\"}},[(!_vm.file || (_vm.autofocus && !_vm.ready))?_c('div',{staticClass:\"empty-workspace\",on:{\"click\":_vm.createNew}},[_c('p',{staticClass:\"placeholder\"},[_vm._v(\"\\n\\t\\t\\t\"+_vm._s(_vm.t('text', 'Add notes, lists or links …'))+\"\\n\\t\\t\")])]):_vm._e(),_vm._v(\" \"),(_vm.file)?_c('EditorWrapper',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.ready),expression:\"ready\"}],key:_vm.file.id,attrs:{\"file-id\":_vm.file.id,\"relative-path\":_vm.file.path,\"share-token\":_vm.shareToken,\"active\":true,\"autohide\":true,\"mime\":_vm.file.mimetype,\"autofocus\":_vm.autofocus},on:{\"ready\":function($event){_vm.ready=true}}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/*\n * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>\n *\n * @author Julius Härtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Callback that should be executed after the document is ready\n * @param callback\n */\nimport axios from '@nextcloud/axios'\nimport { generateRemoteUrl } from '@nextcloud/router'\nimport { openMimetypes } from './mime'\nimport RichWorkspace from '../views/RichWorkspace'\n\nconst FILE_ACTION_IDENTIFIER = 'Edit with text app'\n\nconst fetchFileInfo = async function(user, path) {\n\tconst response = await axios({\n\t\tmethod: 'PROPFIND',\n\t\turl: generateRemoteUrl(`dav/files/${user}${path}`),\n\t\theaders: {\n\t\t\trequesttoken: OC.requestToken,\n\t\t\t'content-Type': 'text/xml',\n\t\t},\n\t\tdata: `<?xml version=\"1.0\"?>\n<d:propfind  xmlns:d=\"DAV:\" xmlns:oc=\"http://owncloud.org/ns\" xmlns:nc=\"http://nextcloud.org/ns\" xmlns:ocs=\"http://open-collaboration-services.org/ns\">\n  <d:prop>\n    <d:getlastmodified />\n    <d:getetag />\n    <d:getcontenttype />\n    <d:resourcetype />\n    <oc:fileid />\n    <oc:permissions />\n    <oc:size />\n    <d:getcontentlength />\n    <nc:has-preview />\n    <nc:mount-type />\n    <nc:is-encrypted />\n    <ocs:share-permissions />\n    <oc:tags />\n    <oc:favorite />\n    <oc:comments-unread />\n    <oc:owner-id />\n    <oc:owner-display-name />\n    <oc:share-types />\n  </d:prop>\n</d:propfind>`,\n\t})\n\n\tconst files = OCA.Files.App.fileList.filesClient._client.parseMultiStatus(response.data)\n\treturn files.map(file => {\n\t\tconst fileInfo = OCA.Files.App.fileList.filesClient._parseFileInfo(file)\n\t\tfileInfo.href = file.href\n\t\treturn fileInfo\n\t})\n}\n\nconst registerFileCreate = () => {\n\tconst newFileMenuPlugin = {\n\t\tattach: function(menu) {\n\t\t\tconst fileList = menu.fileList\n\n\t\t\t// only attach to main file list, public view is not supported yet\n\t\t\tif (fileList.id !== 'files' && fileList.id !== 'files.public') {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// register the new menu entry\n\t\t\tmenu.addMenuEntry({\n\t\t\t\tid: 'file',\n\t\t\t\tdisplayName: t('text', 'New text document'),\n\t\t\t\ttemplateName: t('text', 'New text document') + '.md',\n\t\t\t\ticonClass: 'icon-filetype-text',\n\t\t\t\tfileType: 'file',\n\t\t\t\tactionHandler: function(name) {\n\t\t\t\t\tfileList.createFile(name).then(function(status, data) {\n\t\t\t\t\t\tconst fileInfoModel = new OCA.Files.FileInfoModel(data)\n\t\t\t\t\t\tif (typeof OCA.Viewer !== 'undefined') {\n\t\t\t\t\t\t\tOCA.Files.fileActions.triggerAction('view', fileInfoModel, fileList)\n\t\t\t\t\t\t} else if (typeof OCA.Viewer === 'undefined') {\n\t\t\t\t\t\t\tOCA.Files.fileActions.triggerAction(FILE_ACTION_IDENTIFIER, fileInfoModel, fileList)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t})\n\t\t},\n\t}\n\tOC.Plugins.register('OCA.Files.NewFileMenu', newFileMenuPlugin)\n}\n\nconst registerFileActionFallback = () => {\n\tconst sharingToken = document.getElementById('sharingToken') ? document.getElementById('sharingToken').value : null\n\tconst dir = document.getElementById('dir').value\n\n\tif (!sharingToken || dir !== '') {\n\t\tconst ViewerRoot = document.createElement('div')\n\t\tViewerRoot.id = 'text-viewer-fallback'\n\t\tdocument.body.appendChild(ViewerRoot)\n\t\tconst registerAction = (mime) => OCA.Files.fileActions.register(\n\t\t\tmime,\n\t\t\tFILE_ACTION_IDENTIFIER,\n\t\t\tOC.PERMISSION_UPDATE | OC.PERMISSION_READ,\n\t\t\tOC.imagePath('core', 'actions/rename'),\n\t\t\t(filename) => {\n\t\t\t\tconst file = window.FileList.findFile(filename)\n\t\t\t\tPromise.all([\n\t\t\t\t\timport('vue'),\n\t\t\t\t\timport(/* webpackChunkName: \"files-modal\" */'./../components/PublicFilesEditor'),\n\t\t\t\t]).then((imports) => {\n\t\t\t\t\tconst path = window.FileList.getCurrentDirectory() + '/' + filename\n\t\t\t\t\tconst Vue = imports[0].default\n\t\t\t\t\tVue.prototype.t = window.t\n\t\t\t\t\tVue.prototype.n = window.n\n\t\t\t\t\tVue.prototype.OCA = window.OCA\n\t\t\t\t\tconst Editor = imports[1].default\n\t\t\t\t\tconst vm = new Vue({\n\t\t\t\t\t\trender: h => h(Editor, {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tfileId: file ? file.id : null,\n\t\t\t\t\t\t\t\tactive: true,\n\t\t\t\t\t\t\t\tshareToken: sharingToken,\n\t\t\t\t\t\t\t\trelativePath: path,\n\t\t\t\t\t\t\t\tmimeType: file.mimetype,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}),\n\t\t\t\t\t})\n\t\t\t\t\tvm.$mount(ViewerRoot)\n\t\t\t\t})\n\t\t\t},\n\t\t\tt('text', 'Edit')\n\t\t)\n\n\t\tfor (let i = 0; i < openMimetypes.length; i++) {\n\t\t\tregisterAction(openMimetypes[i])\n\t\t\tOCA.Files.fileActions.setDefault(openMimetypes[i], FILE_ACTION_IDENTIFIER)\n\t\t}\n\t}\n\n}\n\nconst FilesWorkspacePlugin = {\n\n\tel: null,\n\n\tattach: function(fileList) {\n\t\tif (fileList.id !== 'files' && fileList.id !== 'files.public') {\n\t\t\treturn\n\t\t}\n\n\t\tthis.el = document.createElement('div')\n\t\tfileList.registerHeader({\n\t\t\tid: 'workspace',\n\t\t\tel: this.el,\n\t\t\trender: this.render.bind(this),\n\t\t\tpriority: 10,\n\t\t})\n\t},\n\n\trender: function(fileList) {\n\n\t\timport('vue').then((module) => {\n\t\t\tconst Vue = module.default\n\t\t\tthis.el.id = 'files-workspace-wrapper'\n\t\t\tVue.prototype.t = window.t\n\t\t\tVue.prototype.n = window.n\n\t\t\tVue.prototype.OCA = window.OCA\n\t\t\tconst View = Vue.extend(RichWorkspace)\n\t\t\tconst vm = new View({\n\t\t\t\tpropsData: {\n\t\t\t\t\tpath: fileList.getCurrentDirectory(),\n\t\t\t\t},\n\t\t\t}).$mount(this.el)\n\n\t\t\tfileList.$el.on('changeDirectory', data => {\n\t\t\t\tvm.path = data.dir.toString()\n\t\t\t})\n\t\t})\n\t},\n}\n\nexport {\n\tfetchFileInfo,\n\tregisterFileActionFallback,\n\tregisterFileCreate,\n\tFilesWorkspacePlugin,\n\tFILE_ACTION_IDENTIFIER,\n}\n","import mod from \"-!../../node_modules/vue-style-loader/index.js!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBar.vue?vue&type=style&index=0&id=58a92139&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/vue-style-loader/index.js!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBar.vue?vue&type=style&index=0&id=58a92139&scoped=true&lang=scss&\"","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".menubar[data-v-58a92139]{position:fixed;position:-webkit-sticky;position:sticky;top:0;display:flex;z-index:10010;background-color:var(--color-main-background-translucent);height:44px}.menubar.autohide[data-v-58a92139]{visibility:hidden;opacity:0;transition:visibility 0.2s 0.4s, opacity 0.2s 0.4s}.menubar.autohide.is-focused[data-v-58a92139]{visibility:visible;opacity:1}.menubar .menubar-icons[data-v-58a92139]{flex-grow:1;margin-left:calc((100% - 660px) / 2)}@media (max-width: 660px){.menubar .menubar-icons[data-v-58a92139]{margin-left:0}}.menubar button[data-v-58a92139]{width:44px;height:44px;margin:0;background-size:16px;border:0;background-color:transparent;opacity:.5;color:var(--color-main-text);background-position:center center;vertical-align:top}.menubar button[data-v-58a92139]:hover,.menubar button[data-v-58a92139]:focus,.menubar button[data-v-58a92139]:active{background-color:var(--color-background-dark)}.menubar button.is-active[data-v-58a92139],.menubar button[data-v-58a92139]:hover,.menubar button[data-v-58a92139]:focus{opacity:1}.menubar button.icon-undo[data-v-58a92139],.menubar button.icon-redo[data-v-58a92139]{opacity:.4}.menubar .submenu[data-v-58a92139]{display:inline-block;width:44px;height:44px;position:relative;vertical-align:top}\\n\", \"\"]);\n","import mod from \"-!../../node_modules/vue-style-loader/index.js!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBubble.vue?vue&type=style&index=0&id=b937b670&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/vue-style-loader/index.js!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBubble.vue?vue&type=style&index=0&id=b937b670&scoped=true&lang=scss&\"","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".menububble[data-v-b937b670]{position:absolute;display:flex;z-index:10020;background:var(--color-main-background-translucent);box-shadow:0 1px 5px var(--color-box-shadow);border-radius:5px;padding:0.3rem;margin-bottom:0.5rem;visibility:hidden;opacity:0;transform:translateX(-50%);transition:opacity 0.2s, visibility 0.2s}.menububble.is-active[data-v-b937b670]{opacity:1;visibility:visible}.menububble__button[data-v-b937b670]{display:inline-flex;border:0;padding:0.2rem 0.5rem;margin-right:0.2rem;border-radius:3px;cursor:pointer}.menububble__button[data-v-b937b670]:last-child{margin-right:0}.menububble__form[data-v-b937b670]{display:flex;align-items:center}.menububble__input[data-v-b937b670]{font:inherit;border:none;background:transparent;min-width:150px}\\n\", \"\"]);\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('EditorMenuBar',{attrs:{\"editor\":_vm.editor},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar commands = ref.commands;\nvar isActive = ref.isActive;\nvar focused = ref.focused;\nreturn [_c('div',{staticClass:\"menubar\",class:{ 'is-focused': focused, 'autohide': _vm.autohide }},[(_vm.isRichEditor)?_c('div',{ref:\"menubar\",staticClass:\"menubar-icons\"},[_vm._l((_vm.allIcons),function(icon,$index){return [(icon.class)?_c('button',{directives:[{name:\"show\",rawName:\"v-show\",value:($index < _vm.iconCount),expression:\"$index < iconCount\"}],key:icon.label,class:_vm.getIconClasses(isActive, icon),attrs:{\"title\":icon.label},on:{\"click\":function($event){return _vm.clickIcon(commands, icon)}}}):[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:($index < _vm.iconCount),expression:\"$index < iconCount\"},{name:\"click-outside\",rawName:\"v-click-outside\",value:(function () { return _vm.hideChildMenu(icon); }),expression:\"() => hideChildMenu(icon)\"}],key:icon.label,staticClass:\"submenu\"},[_c('button',{class:_vm.childIconClass(isActive, icon.children ),attrs:{\"title\":icon.label},on:{\"click\":function($event){$event.preventDefault();return _vm.toggleChildMenu(icon)}}}),_vm._v(\" \"),_c('div',{staticClass:\"popovermenu menu-center\",class:{open: _vm.isChildMenuVisible(icon)}},[_c('PopoverMenu',{attrs:{\"menu\":_vm.childPopoverMenu(isActive, commands, icon.children, icon)}})],1)])]]}),_vm._v(\" \"),_c('Actions',[_vm._l((_vm.allIcons),function(icon,$index){return [(icon.class && _vm.isHiddenInMenu($index))?_c('ActionButton',{key:icon.class,attrs:{\"icon\":icon.class},on:{\"click\":function($event){return _vm.clickIcon(commands, icon)}}},[_vm._v(\"\\n\\t\\t\\t\\t\\t\\t\"+_vm._s(icon.label)+\"\\n\\t\\t\\t\\t\\t\")]):(!icon.class && _vm.isHiddenInMenu($index))?_vm._l((icon.children),function(childIcon){return _c('ActionButton',{key:childIcon.class,attrs:{\"icon\":childIcon.class},on:{\"click\":function($event){return _vm.clickIcon(commands, childIcon)}}},[_vm._v(\"\\n\\t\\t\\t\\t\\t\\t\\t\"+_vm._s(childIcon.label)+\"\\n\\t\\t\\t\\t\\t\\t\")])}):_vm._e()]})],2)],2):_vm._e(),_vm._v(\" \"),_vm._t(\"default\",[_vm._v(\"\\n\\t\\t\\tLeft side\\n\\t\\t\")])],2)]}}],null,true)})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/*\n * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>\n *\n * @author Julius Härtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default [\n\t{\n\t\tlabel: t('text', 'Undo'),\n\t\tclass: 'icon-undo',\n\t\tisActive: (isActive) => {},\n\t\taction: (command) => command.undo(),\n\t},\n\t{\n\t\tlabel: t('text', 'Redo'),\n\t\tclass: 'icon-redo',\n\t\tisActive: (isActive) => {},\n\t\taction: (command) => command.redo(),\n\t},\n\t{\n\t\tlabel: t('text', 'Bold'),\n\t\tclass: 'icon-bold',\n\t\tisActive: (isActive) => isActive.strong(),\n\t\taction: (command) => {\n\t\t\treturn command.strong()\n\t\t},\n\t},\n\t{\n\t\tlabel: t('text', 'Italic'),\n\t\tclass: 'icon-italic',\n\t\tisActive: (isActive) => isActive.em(),\n\t\taction: (command) => {\n\t\t\treturn command.em()\n\t\t},\n\t},\n\t{\n\t\tlabel: t('text', 'Strikethrough'),\n\t\tclass: 'icon-strike',\n\t\tisActive: (isActive) => isActive.strike(),\n\t\taction: (command) => {\n\t\t\treturn command.strike()\n\t\t},\n\t},\n\t{\n\t\tlabel: t('text', 'Paragraph'),\n\t\tclass: 'icon-paragraph',\n\t\tisActive: (isActive) => {},\n\t\taction: (command) => {\n\t\t\treturn command.paragraph()\n\t\t},\n\t},\n\t{\n\t\tlabel: t('text', 'Headings'),\n\t\tvisible: false,\n\t\tchildren: [\n\t\t\t{\n\t\t\t\tlabel: t('text', 'Heading 1'),\n\t\t\t\tclass: 'icon-h1',\n\t\t\t\tisActive: (isActive) => isActive.heading({ level: 1 }),\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.heading({ level: 1 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: t('text', 'Heading 2'),\n\t\t\t\tclass: 'icon-h2',\n\t\t\t\tisActive: (isActive) => isActive.heading({ level: 2 }),\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.heading({ level: 2 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: t('text', 'Heading 3'),\n\t\t\t\tclass: 'icon-h3',\n\t\t\t\tisActive: (isActive) => isActive.heading({ level: 3 }),\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.heading({ level: 3 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: t('text', 'Heading 4'),\n\t\t\t\tclass: 'icon-h4',\n\t\t\t\tisActive: (isActive) => isActive.heading({ level: 4 }),\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.heading({ level: 4 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: t('text', 'Heading 5'),\n\t\t\t\tclass: 'icon-h5',\n\t\t\t\tisActive: (isActive) => isActive.heading({ level: 5 }),\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.heading({ level: 5 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: t('text', 'Heading 6'),\n\t\t\t\tclass: 'icon-h6',\n\t\t\t\tisActive: (isActive) => isActive.heading({ level: 6 }),\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.heading({ level: 6 })\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t},\n\t{\n\t\tlabel: t('text', 'Unordered list'),\n\t\tclass: 'icon-ul',\n\t\tisActive: (isActive) => isActive.bullet_list(),\n\t\taction: (command) => {\n\t\t\treturn command.bullet_list()\n\t\t},\n\t},\n\t{\n\t\tlabel: t('text', 'Ordered list'),\n\t\tclass: 'icon-ol',\n\t\tisActive: (isActive) => isActive.ordered_list(),\n\t\taction: (command) => {\n\t\t\treturn command.ordered_list()\n\t\t},\n\t},\n\t{\n\t\tlabel: t('text', 'Blockquote'),\n\t\tclass: 'icon-quote',\n\t\tisActive: (isActive) => isActive.blockquote(),\n\t\taction: (command) => {\n\t\t\treturn command.blockquote()\n\t\t},\n\t},\n\t{\n\t\tlabel: t('text', 'Code block'),\n\t\tclass: 'icon-code',\n\t\tisActive: (isActive) => isActive.code_block(),\n\t\taction: (command) => {\n\t\t\treturn command.code_block()\n\t\t},\n\t},\n]\n","<!--\n  - @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>\n  -\n  - @author Julius Härtl <jus@bitgrid.net>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<EditorMenuBar v-slot=\"{ commands, isActive, focused }\" :editor=\"editor\">\n\t\t<div class=\"menubar\" :class=\"{ 'is-focused': focused, 'autohide': autohide }\">\n\t\t\t<div v-if=\"isRichEditor\" ref=\"menubar\" class=\"menubar-icons\">\n\t\t\t\t<template v-for=\"(icon, $index) in allIcons\">\n\t\t\t\t\t<button v-if=\"icon.class\"\n\t\t\t\t\t\tv-show=\"$index < iconCount\"\n\t\t\t\t\t\t:key=\"icon.label\"\n\t\t\t\t\t\t:title=\"icon.label\"\n\t\t\t\t\t\t:class=\"getIconClasses(isActive, icon)\"\n\t\t\t\t\t\t@click=\"clickIcon(commands, icon)\" />\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div v-show=\"$index < iconCount\"\n\t\t\t\t\t\t\t:key=\"icon.label\"\n\t\t\t\t\t\t\tv-click-outside=\"() => hideChildMenu(icon)\"\n\t\t\t\t\t\t\tclass=\"submenu\">\n\t\t\t\t\t\t\t<button :class=\"childIconClass(isActive, icon.children, )\"\n\t\t\t\t\t\t\t\t:title=\"icon.label\"\n\t\t\t\t\t\t\t\t@click.prevent=\"toggleChildMenu(icon)\" />\n\t\t\t\t\t\t\t<div :class=\"{open: isChildMenuVisible(icon)}\" class=\"popovermenu menu-center\">\n\t\t\t\t\t\t\t\t<PopoverMenu :menu=\"childPopoverMenu(isActive, commands, icon.children, icon)\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t\t<Actions>\n\t\t\t\t\t<template v-for=\"(icon, $index) in allIcons\">\n\t\t\t\t\t\t<ActionButton v-if=\"icon.class && isHiddenInMenu($index)\"\n\t\t\t\t\t\t\t:key=\"icon.class\"\n\t\t\t\t\t\t\t:icon=\"icon.class\"\n\t\t\t\t\t\t\t@click=\"clickIcon(commands, icon)\">\n\t\t\t\t\t\t\t{{ icon.label }}\n\t\t\t\t\t\t</ActionButton>\n\t\t\t\t\t\t<template v-else-if=\"!icon.class && isHiddenInMenu($index)\">\n\t\t\t\t\t\t\t<ActionButton v-for=\"childIcon in icon.children\"\n\t\t\t\t\t\t\t\t:key=\"childIcon.class\"\n\t\t\t\t\t\t\t\t:icon=\"childIcon.class\"\n\t\t\t\t\t\t\t\t@click=\"clickIcon(commands, childIcon)\">\n\t\t\t\t\t\t\t\t{{ childIcon.label }}\n\t\t\t\t\t\t\t</ActionButton>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</template>\n\t\t\t\t</Actions>\n\t\t\t</div>\n\t\t\t<slot>\n\t\t\t\tLeft side\n\t\t\t</slot>\n\t\t</div>\n\t</EditorMenuBar>\n</template>\n\n<script>\nimport { EditorMenuBar } from 'tiptap'\nimport Tooltip from 'nextcloud-vue/dist/Directives/Tooltip'\nimport menuBarIcons from './../mixins/menubar'\nimport { fetchFileInfo } from './../helpers/files'\n\nimport Actions from 'nextcloud-vue/dist/Components/Actions'\nimport ActionButton from 'nextcloud-vue/dist/Components/ActionButton'\nimport PopoverMenu from 'nextcloud-vue/dist/Components/PopoverMenu'\nimport ClickOutside from 'vue-click-outside'\n\nexport default {\n\tname: 'MenuBar',\n\tcomponents: {\n\t\tEditorMenuBar,\n\t\tActionButton,\n\t\tPopoverMenu,\n\t\tActions,\n\t},\n\tdirectives: {\n\t\tTooltip,\n\t\tClickOutside,\n\t},\n\tprops: {\n\t\teditor: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tisRichEditor: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tautohide: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata: () => {\n\t\treturn {\n\t\t\twindowWidth: 0,\n\t\t\twindowHeight: 0,\n\t\t\tforceRecompute: 0,\n\t\t\tsubmenuVisibility: {},\n\t\t\ticons: [...menuBarIcons],\n\t\t}\n\t},\n\tcomputed: {\n\t\tisPublic() {\n\t\t\treturn document.getElementById('isPublic') && document.getElementById('isPublic').value === '1'\n\t\t},\n\t\tisHiddenInMenu() {\n\t\t\treturn ($index) => $index - this.iconCount >= 0\n\t\t},\n\t\tgetIconClasses() {\n\t\t\treturn (isActive, icon) => {\n\t\t\t\tconst classes = {\n\t\t\t\t\t'is-active': icon.isActive(isActive),\n\t\t\t\t}\n\t\t\t\tclasses[icon.class] = true\n\t\t\t\treturn classes\n\t\t\t}\n\t\t},\n\t\tisChildMenuVisible() {\n\t\t\treturn (icon) => {\n\t\t\t\treturn this.submenuVisibility.hasOwnProperty(icon.label) ? this.submenuVisibility[icon.label] : false\n\t\t\t}\n\t\t},\n\t\tallIcons() {\n\t\t\tif (this.isPublic) {\n\t\t\t\treturn this.icons\n\t\t\t}\n\t\t\treturn [...this.icons, {\n\t\t\t\tlabel: t('text', 'Insert image'),\n\t\t\t\tclass: 'icon-image',\n\t\t\t\tisActive: () => {\n\t\t\t\t},\n\t\t\t\taction: (commands) => {\n\t\t\t\t\tthis.showImagePrompt(commands.image)\n\t\t\t\t},\n\t\t\t}]\n\t\t},\n\t\tchildPopoverMenu() {\n\t\t\treturn (isActive, commands, icons, parent) => {\n\t\t\t\tconst popoverMenuItems = []\n\t\t\t\tfor (const index in icons) {\n\t\t\t\t\tpopoverMenuItems.push({\n\t\t\t\t\t\ttext: icons[index].label,\n\t\t\t\t\t\ticon: icons[index].class,\n\t\t\t\t\t\taction: () => {\n\t\t\t\t\t\t\ticons[index].action(commands)\n\t\t\t\t\t\t\tthis.hideChildMenu(parent)\n\t\t\t\t\t\t},\n\t\t\t\t\t\tactive: icons[index].isActive(isActive),\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\treturn popoverMenuItems\n\t\t\t}\n\t\t},\n\t\tchildIconClass() {\n\t\t\treturn (isActive, icons) => {\n\t\t\t\tfor (const index in icons) {\n\t\t\t\t\tconst icon = icons[index]\n\t\t\t\t\tif (icon.isActive(isActive)) {\n\t\t\t\t\t\treturn icon.class\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn 'icon-h1'\n\t\t\t}\n\t\t},\n\t\ticonCount() {\n\t\t\tthis.forceRecompute // eslint-disable-line\n\t\t\tthis.windowWidth // eslint-disable-line\n\t\t\tconst menuBarWidth = this.$refs.menubar && this.$refs.menubar.clientWidth > 100 ? this.$refs.menubar.clientWidth : this.windowWidth - 200\n\t\t\tconst iconCount = Math.max((Math.floor(menuBarWidth / 44) - 2), 0)\n\t\t\treturn iconCount\n\t\t},\n\t},\n\tbeforeMount() {\n\t\tthis.redrawMenuBar()\n\t},\n\tmounted() {\n\t\twindow.addEventListener('resize', this.getWindowWidth)\n\t},\n\tbeforeDestroy() {\n\t\twindow.removeEventListener('resize', this.getWindowWidth)\n\t},\n\tmethods: {\n\t\tredrawMenuBar() {\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.getWindowWidth()\n\t\t\t\tthis.forceRecompute++\n\t\t\t})\n\t\t},\n\t\tclickIcon(commands, icon) {\n\t\t\treturn icon.action(commands)\n\t\t},\n\t\tgetWindowWidth(event) {\n\t\t\tthis.windowWidth = document.documentElement.clientWidth\n\t\t},\n\t\tgetWindowHeight(event) {\n\t\t\tthis.windowHeight = document.documentElement.clientHeight\n\t\t},\n\t\thideChildMenu(icon) {\n\t\t\tthis.$set(this.submenuVisibility, icon.label, false)\n\t\t},\n\t\ttoggleChildMenu(icon) {\n\t\t\tconst lastValue = this.submenuVisibility.hasOwnProperty(icon.label) ? this.submenuVisibility[icon.label] : false\n\t\t\tthis.$set(this.submenuVisibility, icon.label, !lastValue)\n\t\t},\n\t\tshowImagePrompt(command) {\n\t\t\tconst currentUser = OC.getCurrentUser()\n\t\t\tif (!currentUser) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tconst _command = command\n\t\t\tOC.dialogs.filepicker('Insert an image', (file) => {\n\t\t\t\tfetchFileInfo(currentUser.uid, file).then((info) => {\n\t\t\t\t\tconst fileInfo = info[0]\n\t\t\t\t\tconsole.debug(fileInfo)\n\t\t\t\t\tconst previewUrl = OC.generateUrl('/core/preview?') + `fileId=${fileInfo.id}&x=1024&y=1024&a=true`\n\t\t\t\t\tconst internalLink = OC.generateUrl('/f/' + fileInfo.id)\n\n\t\t\t\t\t// dirty but works so we have the information stored in markdown\n\t\t\t\t\tconst appendMeta = {\n\t\t\t\t\t\tmimetype: fileInfo.mimetype,\n\t\t\t\t\t\thasPreview: fileInfo.hasPreview,\n\t\t\t\t\t\tfileId: fileInfo.id,\n\t\t\t\t\t}\n\t\t\t\t\tconst src = (fileInfo.hasPreview ? previewUrl : internalLink)\n\t\t\t\t\t\t+ '#'\n\t\t\t\t\t\t+ Object.entries(appendMeta).map(([key, val]) => `${key}=${encodeURIComponent(val)}`).join('&')\n\n\t\t\t\t\t_command({\n\t\t\t\t\t\tsrc: src,\n\t\t\t\t\t\talt: fileInfo.name,\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}, false, [], true)\n\t\t},\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\n\t.menubar {\n\t\tposition: fixed;\n\t\tposition: -webkit-sticky;\n\t\tposition: sticky;\n\t\ttop: 0;\n\t\tdisplay: flex;\n\t\tz-index: 10010; // above modal-header so buttons are clickable\n\t\tbackground-color: var(--color-main-background-translucent);\n\t\theight: 44px;\n\n\t\t&.autohide {\n\t\t\tvisibility: hidden;\n\t\t\topacity: 0;\n\t\t\ttransition: visibility 0.2s 0.4s, opacity 0.2s 0.4s;\n\t\t\t&.is-focused {\n\t\t\t\tvisibility: visible;\n\t\t\t\topacity: 1;\n\t\t\t}\n\t\t}\n\t\t.menubar-icons {\n\t\t\tflex-grow: 1;\n\t\t\tmargin-left: calc((100% - 660px) / 2);\n\t\t}\n\t\t@media (max-width: 660px) {\n\t\t\t.menubar-icons {\n\t\t\t\tmargin-left: 0;\n\t\t\t}\n\t\t}\n\t}\n\n\t.menubar button {\n\t\twidth: 44px;\n\t\theight: 44px;\n\t\tmargin: 0;\n\t\tbackground-size: 16px;\n\t\tborder: 0;\n\t\tbackground-color: transparent;\n\t\topacity: .5;\n\t\tcolor: var(--color-main-text);\n\t\tbackground-position: center center;\n\t\tvertical-align: top;\n\t\t&:hover, &:focus, &:active {\n\t\t\tbackground-color: var(--color-background-dark);\n\t\t}\n\t\t&.is-active,\n\t\t&:hover,\n\t\t&:focus {\n\t\t\topacity: 1;\n\t\t}\n\n\t\t&.icon-undo, &.icon-redo {\n\t\t\topacity: .4;\n\t\t}\n\t}\n\n\t.menubar .submenu {\n\t\tdisplay: inline-block;\n\t\twidth: 44px;\n\t\theight: 44px;\n\t\tposition: relative;\n\t\tvertical-align: top;\n\t}\n</style>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MenuBar.vue?vue&type=template&id=58a92139&scoped=true&\"\nimport script from \"./MenuBar.vue?vue&type=script&lang=js&\"\nexport * from \"./MenuBar.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MenuBar.vue?vue&type=style&index=0&id=58a92139&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"58a92139\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('EditorMenuBubble',{staticClass:\"menububble\",attrs:{\"editor\":_vm.editor},on:{\"hide\":_vm.hideLinkMenu},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar commands = ref.commands;\nvar isActive = ref.isActive;\nvar getMarkAttrs = ref.getMarkAttrs;\nvar menu = ref.menu;\nreturn [_c('div',{staticClass:\"menububble\",class:{ 'is-active': menu.isActive },style:((\"left: \" + (menu.left) + \"px; bottom: \" + (menu.bottom) + \"px;\"))},[(_vm.linkMenuIsActive)?_c('form',{staticClass:\"menububble__form\",on:{\"submit\":function($event){$event.preventDefault();return _vm.setLinkUrl(commands.link, _vm.linkUrl)}}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.linkUrl),expression:\"linkUrl\"}],ref:\"linkInput\",staticClass:\"menububble__input\",attrs:{\"type\":\"text\",\"placeholder\":\"https://\"},domProps:{\"value\":(_vm.linkUrl)},on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"esc\",27,$event.key,[\"Esc\",\"Escape\"])){ return null; }return _vm.hideLinkMenu($event)},\"input\":function($event){if($event.target.composing){ return; }_vm.linkUrl=$event.target.value}}}),_vm._v(\" \"),_c('button',{staticClass:\"menububble__button icon-confirm\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.setLinkUrl(commands.link, _vm.linkUrl)}}})]):[_c('button',{staticClass:\"menububble__button\",class:{ 'is-active': isActive.link() },on:{\"click\":function($event){_vm.showLinkMenu(getMarkAttrs('link'))}}},[_c('span',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(isActive.link() ? 'Update Link' : 'Add Link'),expression:\"isActive.link() ? 'Update Link' : 'Add Link'\"}],staticClass:\"icon-link\"}),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.t('text', 'Add link')))])])]],2)]}}])})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBubble.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBubble.vue?vue&type=script&lang=js&\"","<!--\n  - @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>\n  -\n  - @author Julius Härtl <jus@bitgrid.net>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<EditorMenuBubble v-slot=\"{ commands, isActive, getMarkAttrs, menu }\"\n\t\tclass=\"menububble\"\n\t\t:editor=\"editor\"\n\t\t@hide=\"hideLinkMenu\">\n\t\t<div class=\"menububble\" :class=\"{ 'is-active': menu.isActive }\" :style=\"`left: ${menu.left}px; bottom: ${menu.bottom}px;`\">\n\t\t\t<form v-if=\"linkMenuIsActive\" class=\"menububble__form\" @submit.prevent=\"setLinkUrl(commands.link, linkUrl)\">\n\t\t\t\t<input ref=\"linkInput\"\n\t\t\t\t\tv-model=\"linkUrl\"\n\t\t\t\t\tclass=\"menububble__input\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tplaceholder=\"https://\"\n\t\t\t\t\t@keydown.esc=\"hideLinkMenu\">\n\t\t\t\t<button class=\"menububble__button icon-confirm\" type=\"button\" @click=\"setLinkUrl(commands.link, linkUrl)\" />\n\t\t\t</form>\n\n\t\t\t<template v-else>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"menububble__button\"\n\t\t\t\t\t:class=\"{ 'is-active': isActive.link() }\"\n\t\t\t\t\t@click=\"showLinkMenu(getMarkAttrs('link'))\">\n\t\t\t\t\t<span v-tooltip=\"isActive.link() ? 'Update Link' : 'Add Link'\" class=\"icon-link\" />\n\t\t\t\t\t<span>{{ t('text', 'Add link') }}</span>\n\t\t\t\t</button>\n\t\t\t</template>\n\t\t</div>\n\t</EditorMenuBubble>\n</template>\n\n<script>\nimport { EditorMenuBubble } from 'tiptap'\nimport Tooltip from 'nextcloud-vue/dist/Directives/Tooltip'\n\nexport default {\n\tname: 'MenuBubble',\n\tcomponents: {\n\t\tEditorMenuBubble,\n\t},\n\tdirectives: {\n\t\ttooltip: Tooltip,\n\t},\n\tprops: {\n\t\teditor: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tdata: () => {\n\t\treturn {\n\t\t\tlinkUrl: null,\n\t\t\tlinkMenuIsActive: false,\n\t\t}\n\t},\n\tmethods: {\n\t\tshowLinkMenu(attrs) {\n\t\t\tthis.linkUrl = attrs.href\n\t\t\tthis.linkMenuIsActive = true\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.$refs.linkInput.focus()\n\t\t\t})\n\t\t},\n\t\thideLinkMenu() {\n\t\t\tthis.linkUrl = null\n\t\t\tthis.linkMenuIsActive = false\n\t\t},\n\n\t\tsetLinkUrl(command, url) {\n\t\t\tif (url && !url.match(/^[a-zA-Z]+:\\/\\//) && !url.match(/^\\//)) {\n\t\t\t\turl = 'https://' + url\n\t\t\t}\n\t\t\tcommand({ href: url })\n\t\t\tthis.hideLinkMenu()\n\t\t},\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\n\t.menububble {\n\t\tposition: absolute;\n\t\tdisplay: flex;\n\t\tz-index: 10020;\n\t\tbackground: var(--color-main-background-translucent);\n\t\tbox-shadow: 0 1px 5px var(--color-box-shadow);\n\t\tborder-radius: 5px;\n\t\tpadding: 0.3rem;\n\t\tmargin-bottom: 0.5rem;\n\t\tvisibility: hidden;\n\t\topacity: 0;\n\t\ttransform: translateX(-50%);\n\t\ttransition: opacity 0.2s, visibility 0.2s;\n\n\t\t&.is-active {\n\t\t\topacity: 1;\n\t\t\tvisibility: visible;\n\t\t}\n\n\t\t&__button {\n\t\t\tdisplay: inline-flex;\n\t\t\tborder: 0;\n\t\t\tpadding: 0.2rem 0.5rem;\n\t\t\tmargin-right: 0.2rem;\n\t\t\tborder-radius: 3px;\n\t\t\tcursor: pointer;\n\n\t\t\t&:last-child {\n\t\t\t\tmargin-right: 0;\n\t\t\t}\n\t\t}\n\n\t\t&__form {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t}\n\n\t\t&__input {\n\t\t\tfont: inherit;\n\t\t\tborder: none;\n\t\t\tbackground: transparent;\n\t\t\tmin-width: 150px;\n\t\t}\n\t}\n</style>\n","import { render, staticRenderFns } from \"./MenuBubble.vue?vue&type=template&id=b937b670&scoped=true&\"\nimport script from \"./MenuBubble.vue?vue&type=script&lang=js&\"\nexport * from \"./MenuBubble.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MenuBubble.vue?vue&type=style&index=0&id=b937b670&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b937b670\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}